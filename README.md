# py-ts-api  
## A REST API for TeamSpeak Serverquery written in Python  
  
#### Dependencies
* Python 3+ (i recommend 3.6.2)
* pyenv (optional)
* PiP
  * flaskapi
  * flask_httpauth
  * jwcrypto
  * ts3 (py-ts3)
  
#### Installation
I recommend using a virtual python enviroment and will be using pyenv-virtualenv in this explanation  
Clone the repo and switch to it  
    `git clone https://gitlab.com/audron/py-ts-api.git`  
    `cd py-ts-api`  
Install python version and create virtualenv  
    `pyenv install 3.6.2`  
    `pyenv virtualenv 3.6.2 py-ts-api`  
Set local python version to our virtualenv  
    `pyenv local py-ts-api`  
Install dependencies  
    `pip install -r requirements.txt`  
  
You are now ready to run the API in a development enviroment with `./app.py` if you are only using it in private this may be ok but for heavier usage i highly recommend deploying it to a production environment.
For more details on that refer to the [Flask documentation](http://flask.pocoo.org/docs/0.12/deploying/#deployment)  
  
### Usage  
#### Authentification:  
**URL** `/auth`  
Return a encrypted token that is used for any further authentifications.  
  
**Headers:**  
**Authorization:** Username and Password of a valid serverquery user formated as HTTP Basic Auth  
**ip:** IP of the Teamspeak server you want to query  
  
  
#### Get Requests:  
**URL** `/get/<command>`  
Used to GET information from the server e.g. `clientlist`  
Substitute `<command>` for a valid serverquery command e.g. `clientlist`  
  
**Headers:**  
**Authorization:** Token that has been generated by `/auth` as Bearer Token
**sid:** ID of the virtual server you want to query. Needs to be suplied even if need needed by the command.  
  
  
#### Post Request:  
**URL** `/post/<command>`  
Used to submit data to the server e.g. `clientpoke`  
Substitute `<command>` for a valid serverquery command e.g. `clientpoke`  
  
**Headers:**  
**Authorization:** Token that has been generated by `/auth` as Bearer Token  
**sid:** ID of the virtual server you want to query. Needs to be suplied even if need needed by the command.  
Content-Type: `application/json`  
  
**Body:**  
JSON formated data. All `key:value` pairs need for a specific command. Order of keys doesn't matter  
for `clientpoke` e.g. `{"clid": "14", "msg": "test"}`  
